Section,Title,Profile Level,Profile,Description,Impact,Rationale,Remediation
,,,"Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 2, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 2, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 1, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 2, Profile Applicability:, Level 1, Profile Applicability:, Level 1, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2, Profile Applicability:, Level 2","Fortinet uses the Domain Name Service (DNS) to translate host names into IP addresses. To enable DNS lookups, you must specify the primary DNS server for your system. You can also specify secondary and tertiary DNS servers. When resolving host names, the system consults the primary name server. If a failure or time-out occurs, the system consults the secondary name server Description: This is to make sure that only specific, authorized traffic are allowed between networks in the same zone. Description: Enabling any management related services on WAN interface is high risk. Management related services such as HTTPS, HTTP, ping, SSH, SNMP, and Radius should be disabled on WAN. Description: Configure a pre-login banner, ideally approved by the organization’s legal team. This banner should, at minimum, prohibit unauthorized access, provide notice of logging or monitoring, and avoid using the word “welcome” or similar words of invitation. Description: Sets the banner after users successfully login. This is equivalent to Message of the Day (MOTD) in some other systems. Description: Sets the local time zone information so that the time displayed by the device is more relevant to those who are viewing it. Description: You can either manually set the FortiOS system time, or configure the device to automatically keep its system time correct by synchronizing with a Network Time Protocol (NTP) server. These settings enable the use of primary and secondary NTP servers to provide redundancy in case of a failure involving the primary NTP server. Description: Changes the device default hostname. Description: Check against Fortinet website to make sure that the latest stable firmware is installed. Description: Disable USB port auto install feature for config and firmware Description: Disable support for static keys on TLS sessions terminating on the FortiGate Description: Enable FortiOS to only use strong encryption and allow only strong ciphers for communication Description: It is important to use secure and complex passwords for preventing unauthorized access to the FortiGate device. Description: Failed login attempts can indicate malicious attempts to gain access to your network. To prevent this security risk, FortiGate is preconfigured to limit the number of failed administrator login attempts. After the maximum number of failed login attempts is reached, access to the account is blocked for the configured lockout period. Description: The Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system. Description: Ensuring that only SNMPv3 service is enabled and SNMPv1, SNMPv2c are disabled. Description: Before deploying any new FortiGate, it is important to change the password of the default admin account. It is also recommended that you change even the user name of the default admin account; however, since you cannot change the user name of an account that is currently in use, a second administrator account must be created in order to do this. Description: Configure an administrative account to be accessible only to someone who is using a trusted host. You can set a specific IP address for the trusted host or use a subnet. Description: Verify that users with access to the Fortinet should only have the minimum privileges required for that particular user. Description: The idle timeout period is the amount of time that an administrator will stay logged in to the GUI without any activity. Description: Allow only HTTPS access to the GUI and SSH access to the CLI Description: Configure Local-in Policies to control inbound traffic that is destined to a FortiGate interface. Description: Ensure that FortiGate devices are configured for High Availability (HA). Description: Configure Interface Monitoring within High Availability settings, Interface Monitoring should be enabled on all critical interfaces. Description: Ensure Reserved Management Interfaces are configured on HA devices Description: All firewall policies should be reviewed regularly to verify the business purpose. Unused policies should be disabled and logged. Description: We want to make sure that all security policies in effect clearly state which protocols / services they are allowing. Description: Ensure Policies are uniquely named Description: Ensure that there are no firewall policies that are unused Description: Firewall policies should include a deny rule for traffic going to/from Tor or malicious server using ISDB (Internet Service Database). Description: Logging should be enabled for all firewall policies including the default implicit deny policy. Description: Interfaces which are classified as ""WAN"" and are used by a policy should use an IPS sensor which block or monitor outgoing connections to botnet sites. Description: Ensure FortiGate is configured to accept antivirus definition push updates Description: Ensuring that traffic traversing between networks on the FortiGate have an Antivirus Security profile inspecting it. Description: Ensure FortiGate AV inspection uses outbreak prevention database as an added layer of protection on top of antivirus' signature-based detection. Description: AI /heuristic based detection should be enabled. Description: Grayware detection should be enabled. Description: Enable Botnet C&C domain blocking to block botnet access at the DNS name resolving stage Description: DNS filter should log all DNS queries and responses. Description: Ensure FortiGate Application Control blocks high risk application to reduce attack surface. Description: Ensure FortiGate Application Control blocks applications running on non-default ports. Description: Ensure no category is set to ""Allow"" on FortiGate Application Control. Description: Default automation trigger configuration for when a high severity compromised host is detected. Description: Ensure Root FortiGate is configured as security fabric root Description: Apply a signed certificate from a trusted Certificate Authority (CA) to the SSL VPN portal to allow users to connect securely with confidence Description: Enable and disable TLS versions and Cipher suites for more granular control of SSL VPN connections and enforcing more secure connections. Description: Configure maximum user log in attempts and lockout period Description: Enabling event logging to allow for log generation and review. Description: Enable encryption for logs that are sent to FortiAnalyzer or FortiManager Description: Device logs should be sent to a centralized device for log collection, retention, and reporting. This could be a SIEM. syslog device, FortiAnalyzer, FortiManager, etc.","Enabling management related services on WAN port is convenient but it exposes the firewall to unnecessary risks. Vulnerabilities found on vendor devices are commonly related to management services and opening access to these allows attackers to exploit its vulnerabilities. Impact: Login banners provide a definitive warning to any possible intruders that may want to access the FortiGate that certain types of activity are illegal, but at the same time, it also advises the authorized and legitimate users of their obligations relating to acceptable use. Impact: When post-login banner is enabled, some automated-script might be affected because both CLI and GUI need an acceptance action (press ""A"" or ""Accept"") to continue. Impact: For many features to work, including scheduling, logging, and SSL-dependent features, the FortiOS system time must be accurate. Impact: For many features to work, including scheduling, logging, and SSL-dependent features, the FortiOS system time must be accurate. Impact: Weak passwords can be easily discovered by hackers which leads to unauthorized access to FortiGate and depends on the access privilege of the compromised account the attacker may modify the settings. Impact: Attackers will keep attempting to access the device through brute force attacks without any interruption which may lead to a successful login. Impact: SNMP servers will not be able to query the Fortigate devices that have SNMP agents disabled. Impact: Some older SNMP server that only run SNMPv1 or SNMPv2C will not be able to query to this firewall. Impact: if not changed, then any scripts that use default credentials will be able to access the system. Impact: All access, from legitimate or illegitimate users, outside of allowed segment will be stopped. Thus, administrators working remotely will have to make sure that they have access to jump hosts that sit in the allowed segment. Impact: This is to prevent someone from accessing the FortiGate if the management PC is left unattended. Impact: Local-in Policies are processed before ""trusted host"" configurations so it is important to validate that management access will be maintained once the Local-in policies are put in place. Impact: Not having High Availability (HA) configured correctly and synced properly impacts the availability of the FortiGate devices as well as any systems that require traversing the FortiGates. With properly configured HA in place outages can be minimized during firmware updates as well as if there are power outages or device failures. Impact: Not configuring Interface Monitoring can directly impact services due to a failure to trigger a High Availability failover if an interface is impacted only on the primary device and it is not being monitored. Without the Interface monitoring enabled failover would be limited to hardware, system, or power faults. Impact: Not configuring reserved Management Interfaces impacts the ability to access secondary devices directly due to the primary and secondary devices syncing configuration exactly and floating a virtualized mac address between them for failover Impact: By default, when creating firewall policies, logging option is not enabled. Also, the default implicit deny policy is not logged. This creates data gap in threat hunting or incident response activities. Impact: By default, allowed DNS is not logged. This creates data gap in threat hunting or incident response activities. Impact: Visibility gap, affects incident forensics and response. Impact: Without Security Fabric enabled visibility and management of traffic throughout an organization is decreased and individual FortiGate management becomes more intensive","The purpose is to perform the resolution of system hostnames to Internet Protocol (IP) addresses. Rationale: This adds an extra layer of protection between different networks Rationale: Management related services should only be enabled on management interface. This is part of defending the firewall from attacks and reducing attack surface. For WAN related services such as IPSec and SSLVPN, make use of local-in-policy (refer to CIS Section 2.4) to tighten firewall defenses. Rationale: Through a properly stated login banner, the risk of unintentional access to the device by unauthorized users is reduced. Should legal action take place against a person accessing the device without authorization, the login banner greatly diminishes a defendant’s claim of ignorance. Rationale: Network banners are electronic messages that provide notice of legal rights to users of computer networks. From a legal standpoint, banners have four primary functions. First, banners may be used to generate consent to real-time monitoring under Title III. Second, banners may be used to generate consent to the retrieval of stored files and records pursuant to ECPA. Third, in the case of government networks, banners may eliminate any Fourth Amendment ""reasonable expectation of privacy"" that government employees or other users might otherwise retain in their use of the government's network under O'Connor v. Rationale: Having a correct time set on the device is important for two main reasons. The first reason is that digital certificates compare this time to the range defined by their Valid From and Valid To fields to define a specific validity period. The second reason is to have relevant time stamps when logging information. Whether you are sending messages to a Syslog server, sending messages to an SNMP monitoring station, or performing packet captures, timestamps have little usefulness if you cannot be certain of their accuracy. Rationale: NTP enables the device to maintain accurate time and date when receiving updates from a reliable NTP server. Accurate timestamps are critical when correlating events with other systems, troubleshooting, or performing investigative work. Logs and certain cryptographic functions, such as those utilizing certificates, rely on accurate time and date parameters. In addition, rules referencing a Schedule object will not function as intended if the device’s time and date are incorrect. For additional security, authenticated NTP can be utilized. If Symmetric Key authentication is selected, only SHA1 should be used, as MD5 is considered severely compromised. Rationale: The device hostname plays an important role in asset inventory and identification as a security requirement, but also in the public keys and certificate deployments as well as when correlating logs from different systems during an incident handling. Rationale: Fortinet periodically updates the FortiGate firmware to include new features and resolve important issues. After you have registered your FortiGate unit, firmware updates can be downloaded from the Fortinet Customer Service & Support website. It is important to constantly keep the firmware up-to-date to prevent any new well-known exploitation. Rationale: Disabling USB port for auto install prevents a USB from being connected with a manipulated configuration or incorrect firmware from being connected and loaded automatically. Rationale: Prevent TLS sessions terminating on the FortiGate from using static SSL keys Rationale: Rationale: Attackers can use Brute force password software to launch more than just dictionary attacks. such Attacks can discover common passwords where a letter is replaced by a number or symbol. Rationale: When you login and fail to enter the correct password you could be a valid user, or a hacker attempting to gain access. For this reason, best practices dictate to limit the number of failed attempts to login before a lockout period where you cannot login for a certain period of time. lockout period will minimize the hacker attempts to gain access to firewall. Rationale: The SNMP server can communicate using SNMP v1, which transmits data in the clear and does not require authentication to execute commands. Unless absolutely necessary, it is recommended that the SNMP service not be used. If SNMP is required the server should be configured to use only SNMPv3. Rationale: SNMP Version 3 provides security enhancements that are not available in SNMP Version 1 or SNMP Version 2c. SNMP Versions 1 and 2c transmit data between the SNMP server and SNMP agent in clear text. SNMP Version 3 adds authentication and privacy options to secure protocol operations. Some firewalls need to be constantly monitored of its performance and status. Especially if the firewalls are critical to the operation. Enabling SNMPv3 will ensure that the firewall is monitored properly. Rationale: Default credentials are well documented by most vendors including Fortinet. Therefore, it will be one of the first things that will be tried to illegally gain access to the system. Rationale: Access to a firewall to perform administrative tasks should only come from specific network segments reserved for administrators only. This additional layer of security ensure that no one from anywhere else on the network able to login even with correct credentials. Rationale: In some organizations, there are needs to create different levels of administrative accounts. For example, technicians from tier 1 support should not have total access to the system as compared with a tier 3 support. Rationale: Best practice dictates settings admin idle timeout to prevent the risk of unauthorized access to the device by preventing someone from using a logged-in GUI on a PC that has been left unattended. Rationale: By only allowing encrypted access, we are making it harder to use ""Man in the Middle"" attack to sniff login credentials. Rationale: Local-in Policies allow for more granular and specific control of all types of traffic that are destined for a FortiGate interface. They are not limited to management only protocols so they can extend past ""trusted host"" configurations and can be configured with source and destination addresses as well as services specifically. Rationale: Configuring High Availability (HA) increases system availability as well as decreases impact of routine maintenance (Firmware updates, cable moves, etc.) and the the impact of device failure. Rationale: With Interface Monitoring enabled on devices failover can occur if there are physical media issues or issues with the specific port that the FortiGate is connected to. Rationale: To be able to access both the primary and secondary firewalls in an HA cluster Reserved Management Interfaces need to be configured to prevent them from syncing with HA and sharing a virtual MAC address Rationale: By reviewing policies regularly, we can determine if the policies are still needed by the business purpose. Thus, we can keep the firewall policies lean and efficient. It also prevents traffic being allowed or blocked accidently. Rationale: This is to make sure that the firewall do not allow traffic with unauthorized protocols/services by mistakes. Rationale: Uniquely named policies allow for better auditing and prevent multiple policies performing the same actions existing and possibly introducing misconfigurations Rationale: Unused policies may provide unintended or anticipated access to services or hosts Rationale: FortiGate includes Tor or malicious server related IP address using ISDB. The idea is to filter out malicious traffics using firewall policies as first level filtering. This is done without involving more resource intensive process such as IPS inspection, hence optimizing FortiGate's performance. Rationale: Firewall policies should log for all traffic (both allow and deny policies). This enables SOC or security analyst to do further investigations on security incidents especially on threat hunting or incident response activities. Although there are many data sources that can provide DNS query logs (AD or EDR), but this option should be enabled out of best practice and with assumption that no other data sources is available. Rationale: Blocking outgoing connections to known Botnets should be utilized in a Defense In Depth network design Rationale: Ensure that the FortiGate will accept push updates from FortiGuard to ensure the most up to date signature databases are present on the device. Rationale: Traffic moving between ""interfaces"" on the FortiGate should have firewall policies applied with an antivirus security profile applied. Rationale: Antivirus mainly uses signature for malware blocking. By enabling ""FortiGuard outbreak prevention database"", FortiGate can leverage on 3rd party malware hash signatures curated by the FortiGuard as an additional protection layer. The hash signatures are obtained from FortiGuard's Global Threat Intelligence database. The antivirus database queries FortiGuard with the hash of a scanned file. If FortiGuard returns a match, the scanned file is deemed to be malicious. Rationale: The AV Engine AI malware detection model integrates into regular AV scanning to help detect potentially malicious Windows Portable Executables (PEs) in order to mitigate zero-day attacks. It is an additional layer of protection on top of traditional antivirus protection. In version 6.x, it is named ""Heuristic detection"". On version 7.x, Fortinet has renamed this to AI based detection. Rationale: Usage of grayware is generally not allowed in strict company policies and some graywares can be used for malicious intent. If the file passes the virus scan, it can be checked for grayware. Grayware signatures are kept up to date in the same manner as the antivirus definitions. Rationale: Blocking botnet website access at the DNS resolution stage provides an additional layer of defense. Rationale: DNS filter should log all DNS queries and responses (whether if the DNS category is blocked, monitored, or allowed). This enables SOC or security analyst to do further investigations on security incidents especially on threat hunting or incident response activities. Although there are many data sources that can provide DNS query logs (AD or EDR), but this option should be enabled out of best practice and with assumption that no other data sources is available. Rationale: High risk applications such as those in ""P2P"" and ""Proxy"" are known for spreading malwares. Other than that, some of these traffic is encrypted and therefore is able to bypass network security inspection (for those without decryption implemented). Blocking these applications from running eliminates this risk. If any application that falls under ""P2P"" and ""Proxy"" requires to be allowed based on organization's policy, that specific application needs to be under ""Monitor"" mode in the ""Application and Filter Override"" configuration. Rationale: Running application on non-default ports is not directly a threat, but can be an indication of something unexpected. For example, HTTPS runs on port 443. Potentially, if attacker starts a rogue HTTPS server on port 10443, it could be used for data exfiltration. Rationale: Any category that is set as ""Allow"" on Application Control will not be logged. This creates visibility gap on security investigation. This includes ""Unknown Applications"" category. Rationale: By enabling this feature you protect your environment against compromised hosts. Default automation stitch to quarantine a high severity compromised host on FortiAPs, FortiSwitches, and FortiClient EMS. Rationale: Without a root FortiGate configured the security fabric is not functional and can not be leveraged Rationale: Having an unsigned or self signed certificate leaves connections open to man-in-the-middle attacks and could allow users to connect to untrusted servers Rationale: Limiting TLS versions to more secure versions as well as enforcing stronger ciphers increases the security of the SSL VPN connections Rationale: Failed user log in attempts can indicate an attempt to gain access to the network. Limiting the number of attempts before the account is locked for a determined amount of time helps slow down brute force attempts and impedes malicious attempts to access user accounts. Rationale: Enabling event logging generates logs that can be stored for later review or auditing or can be ingested by another system (SIEM, Analyzer) for monitoring and response Rationale: Provides encryption for logs that are sent to FortiAnalyzer or FortiManager to prevent logs being collected and viewed as they traverse the network. Rationale: Centralized logging allows for more reliable log retention and more enriched log data for review and reporting.","In this example, we will assign 8.8.8.8 as primary DNS and 8.8.4.4 as secondary DNS. In CLI: FGT1 # config system dns FGT1 (dns) # set primary 8.8.8.8 FGT1 (dns) # set secondary 8.8.4.4 FGT1 (dns) # end FGT1 # In the GUI, go to Networks -> DNS. Click on ""Specify"" and put in 8.8.8.8 as ""Primary DNS Server"" and 8.8.4.4 as ""Secondary DNS Server"" Remediation: In this example, we'll turn of intra-zone traffic in the zone DMZ. In CLI: FGT1 # config system zone FGT1 (zone) # edit DMZ FGT1 (DMZ) # set intrazone deny FGT1 (DMZ) # end FGT1 # In the GUI, click on Network -> Interfaces, select the zone and click on ""Edit"" and turn on ""Block intra-zone traffic"" Remediation: On GUI: Go to ""Network"" > ""Interfaces"". Review WAN interface and disable HTTPS, HTTP, ping, SSH, SNMP, and Radius services. On CLI: Remediation: Run the following command in the CLI to enable the pre-login-banner: FG1 # config system global FG1 (global) # set pre-login-banner enable FG1 (global) # end FG1 # In the GUI, to edit the content of the pre-login disclaimer message: Remediation: Run the following command in the CLI to enable the post-login-banner: FG1 # config system global FG1 (global) # set post-login-banner enable FG1 (global) # end FG1 # In the GUI, to edit the content of the post-login disclaimer message, go to Remediation: In this example, we will set Eastern Timezone (GMT-5:00) for the Fortigate. Each timezone will have its corresponding ID. To find the correct ID, when you type in the command ""set timezone "", also type the question mark '?' to list all of the available timezones and their IDs. The ID of the Eastern Timezone is 12 In the CLI: Remediation: You can only customize NTP setting using CLI. In this example, we'll assign pool.ntp.org as primary NTP server and 1.1.1.1 as secondary NTP server. FGT1 # config system ntp FGT1 (ntp) # set type custom FGT1 (ntp) # config ntpserver FGT1 (ntpserver) # edit 1 FGT1 (1) # set server pool.ntp.org FGT1 (1) # next FGT1 (ntpserver) # edit 2 FGT1 (2) # set server 1.1.1.1 FGT1 (2) # end FGT1 (ntp) # end FGT1 # Remediation: In CLI, set the hostname to 'New_FGT1' as follows: FGT1 # config system global FGT1 (global) # set hostname ""New_FGT1"" FGT1 (global) # end New_FGT1 # or In GUI, go to 'System' -> 'Settings', update the field 'Hostname' with the new hostname, and click ""Apply"" Remediation: First, determine the upgrade path recommended by Fortinet. If you have not upgraded the system for a long time, it is not recommended to upgrade straight to the latest version as the configuration could be lost. Fortinet provides a tool to recommend an upgrade path for all of its products. Go to https://docs.fortinet.com/upgrade-tool. Choose your product from the ""Current Product"" drop-down menu, the ""current FortiOS version"", and the latest firmware version available for that model from ""Upgrade to FortiOS Version"". Click ""Go"". Write down the path and then click on ""Download"" to download all the necessary versions. The second step is to download the required FortiOS firmware/s. Go to https://support.fortinet.com and login. Go to Support -> Firmware Download. Once there, select the product and click on ""Upgrade Path"". Choose the specific model of the hardware, the current firmware version and the latest firmware version available for that model. Click ""Go"". Write down the path and then click on ""Download"" to download all the necessary versions. The last step is to install the new firmwares in the order provided by the ""Upgrade tool"". It is recommended to use GUI to perform this task as it would be much easier. In the GUI, click on System -> Firmware, then click on ""Browse"" to select the next firmware file. Then click on ""Upgrade"". You might have to perform this step multiple times if you follow the upgrade path. Remediation: CLI: config system auto-install set auto-install-config disable set auto-install-image disable end Remediation: CLI: config system global set ssl-static-key-ciphers disable end Remediation: CLI: config system global set strong-crypto enable end Remediation: can be modified from CLI or GUI From CLI, do the following: Remediation: To configure the lockout options, from CLI: config system global set admin-lockout-threshold 3 set admin-lockout-duration 60 end Remediation: On the CLI, run the following command to disable the agent FGT1 # config system snmp sysinfo FGT1 (sysinfo) # set status disable FGT1 (sysinfo) # end On the GUI, select System -> SNMP, disable SNMP agent Remediation: To enable SNMP agent in CLI FGT1 # config system snmp sysinfo FGT1 (sysinfo) # set status enable FGT1 (sysinfo) # end In GUI, go to System -> SNMP and enable SNMP Agent. To delete SNMPv1/2c communities In this example, we'll delete community ""public"" in CLI FGT1 # config system snmp community FGT1 (community) # delete public FGT1 (community) # end FGT # In the GUI, go to System -> SNMP, select the community and click on the Delete button. To add SNMPv3 User in CLI Remediation: In the CLI, to change the password of account ""admin"" FG1 # config system admin FG1 (admin) # edit ""admin"" FG1 (admin) # set password <your passwords> FG1 (admin) # end FG1 # To change the default password in the GUI: Remediation: To remove a trusted host item from the list in CLI FG1 # config system admin FG1 (admin) # edit ""test_admin"" FG1 (test_admin) # unset trusthost1 FG1 (test_admin) # end FG1 # To add a trusted host into the list in CLI FG1 # config system admin FG1 (admin) # edit ""test_admin"" FG1 (test_admin) # set trusthost6 1.1.1.1 255.255.255.255 FG1 (test_admin) # end FG1 # Before adding an item, please make sure that it does not already exist. For example, if trusthost3 is already in the list, using it again will over-ride the existing host/network. In the web GUI, go to System -> Administrators, select the account and click on edit. In the account setting page, make sure that ""Restrict login to trusted hosts"" are enabled and all the allowed hosts / subnets are in the list of trusted Host. Please take note that certain versions of FortiOS will only show the first 3 trusted hosts in the list. If you want to see more, you have to click on the ""+"" sign as if you're adding a new item into the list. Keep clicking until you see an empty field of trusted host. That's when you know that you have reached the bottom of the list. To add another trusted host, fill in the empty field of the new ""Trusted Host"". To remove a trusted host, simply erase everything in the field of that corresponding host. Remediation: In this example, I would like to provide the profile ""tier_1"" the ability to view and modify address objects. This sub-privilege is under fwgrp privilege. In CLI FGT1 # config system accprofile FGT1 (accprofile) # edit ""tier_1"" FGT1 (tier_1) # set fwgrp custom FGT1 (tier_1) # config fwgrp-permission FGT1 (fwgrp-permission) # set address read-write FGT1 (fwgrp-permission) # end FGT1 (tier_1) # end FGT1 # For the GUI, go to System -> Admin Profiles, select ""tier_1"" and click ""Edit"". On ""Firewall"", click on ""Custom"" and then click on ""Read/Write"" option for ""Address"". In the next example, I would like to assign the profile ""tier_1"" to the account ""support1"". In the CLI FGT1 # config system admin FGT1 (admin) # edit ""support1"" FGT1 (support1) # set accprofile ""tier_1"" FGT1 (support1) # end FGT1 # For the GUI, go to System -> Administrators, select ""support1"" and click ""Edit"". Under ""Administrator Profile"", select ""tier_1"". Remediation: To change the idle timeout in the GUI: 1) Login to FortiGate with Super Admin privileges 2) Go to 'System' > 'Settings'. 3) In the 'Administration Settings' section, set the 'Idle timeout' value to five minutes by typing 5. 4) Click Apply. To change the idle timeout in the CLI: Remediation: If HTTP or Telnet is in the allowaccess list, you will have to set that list again with the same elements except for http or telnet FG1 # config system interface FG1 (interface) # edit port1 FG1 (port1) # set allowaccess ssh https ping snmp FG1 (port1) # end FG1 # In the web GUI, click on Remediation: Local-in Policies can only be configured through the CLI: Remediation: In GUI: Navigate to ""System"" and then ""HA"" Ensure ""Mode"" is set to proper setting ""Active-Active"" or ""Active-Passive"" Review Configuration settings ""Cluster Name"" must match on devices ""Password"" Must match on devices ""Heartbeat Interfaces"" need to be defined on devices Click ""OK"" to save changes and exit In CLI: FGT1 # config system ha FGT1 (ha) # set mode a-p ###(Active-Passive) FGT1 (ha) # set group-name ""FGT-HA"" ###(Set cluster name) FGT1 (ha) # set password ******* ###(Set password) FGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat Interface and priority) FGT1 (ha) # end To review configuration in CLI FGT1 # config system ha FGT1 (ha) # show config system ha set group-name ""FGT-HA"" set mode a-p set password ENC enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgoprYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw== set hbdev ""port10"" 50 set override disable end Remediation: To Remediate from GUI: Remediation: Remediate through the GUI: go to System -> HA edit the ""Master"" device and enable ""Management Interface Reservation"" once this is enabled select an an interface, and configure the appropriate gateway. Remediate through the CLI: Remediation: The remediation is to review and decide if you should delete unused policies. Remediation: In this example, we will modify policy with ID of 2 to change the service from ""ALL"" to FTP and SNMP In CLI: Remediation: Provide all firewall policies with a unique name Remediation: Disable and then delete any used firewall policies Remediation: Review firewall policies and ensure there are: 1. A firewall policy created to block inbound connections with these settings: From: Any To: Any Source: ""Tor-Exit.Node"", ""Tor-Relay.Node"", and ""Malicious-Malicious.Server"" Destination: all Schedule: Always Services: All Action: Deny Log Violation Traffic: Enabled Enable this policy: Enabled 2. A firewall policy created to block outbound connections with these settings: Remediation: Review firewall policies and ensure that: For allowed policies, ""Log Allowed Traffic"" is set on ""All Sessions"" option For denied policies, ""Log Violation Traffic"" is enabled. Remediation: Apply an IPS Sensor with ""Scan Outgoing Connections to Botnet Sites"" set to ""Block"" on all firewall policies with traffic exiting the network to a ""WAN"" interface. Remediation: GUI (FortiOS 6): Access the FortiGate administrative web access page and go to System > FortiGuard under 'FortiGuard Updates"" enable ""Accept push updates"". GUI (FortiOS 7): Access the FortiGate administrative web access page and go to System > FortiGuard under ""FortiGuard Updates"" ensure that the ""Scheduled updates"" is set to ""Automatic"". CLI (FortiOS 6): Remediation: Review firewall policies and apply an appropriate antivirus security profile to policies Remediation: Review Antivirus Security Profiles and validate that ""Use FortiGuard outbreak prevention database"" is enabled. Remediation: FGT1 # config antivirus settings FGT1 (settings) # set machine-learning-detection enable Remediation: FGT1 # config antivirus settings FGT1 (settings) # set grayware enable Remediation: Review DNS Filter Security Profiles and validate that ""Redirect botnet C&C requests to Block Portal"" is enabled and that firewall policies that have DNS traffic have a DNS Filter security profile applied with that option enabled Remediation: Review DNS Filter Security Profiles and validate that ""Log all DNS queries and responses"" is enabled. Remediation: Review Application Control Security Profiles and validate that ""P2P"" and ""Proxy"" category is blocked. Remediation: GUI: Go to ""Security Profiles"" > ""Application Control"" > select App Control profile Enable ""Block applications detected on non-default ports"" option CLI: FGT1 # config application list FGT1 (list) # edit <profile name> FGT1 (<profile name>) # set enforce-default-app-port enable Remediation: Review Application Control Security Profiles and validate that no ""Allow"" action is set on any categories. Remediation: GUI Security Fabric>Automation Edit and change Disabled to Enabled CLI Remediation: Remediation through the GUI: To configure root FortiGate status go to ""Security Fabric"" -> Fabric Connectors and then select ""Security Fabric Setup"" On the root FortiGate set the status to enabled and the Security Fabric Role to ""Serve as Fabric Root"" Configure FortiAnalyzer settings when prompted and define a Fabric name as well as interfaces that will ""Allow other Security Fabric Devices to Join"". Remediation: Import a signed certificate from a trusted CA through the GUI System > Certificates > Import and then assign the certificate to the SSL VPN portal by going to VPN > SSL-VPN Settings and selecting the proper certificate in the dropdown for ""Server Certifcate"" Remediation: CLI: config vpn ssl settings set ssl-max-prot-ver *** {Configure max TLS Version supported} set ssl-min-proto ver *** {set minimum support TLS version} set banned-cipher *** {add cipher suite to banned list and prevent it from being used} set algorithm high {use high algorithms} Remediation: CLI: config user setting set auth-lockout-threshold 5 end config user setting set auth-lockout-duration 300 end Remediation: Access the FortiGate administrative web access page and go to Log & Report > Log Settings enable Event Logging. CLI: config log eventfilter set event enable end Remediation: GUI: Access the FortiGate administrative web access page and go to Log & Report > Log Settings and when configuring Remote logging to FortiAnalyzer/FortiManager select ""Encrypt log transmission"" CLI: config log fortianalyzer setting set enc-algorithm high end Remediation: Configure a remote server for logs to be sent to. Access the FortiGate administrative web access page and to to Log & Report > Log Settings and under ""Remote Logging and Archiving"" configure a remote server to send logs to."
