Title,Description,Remediation,PowerShell Script,Returned Value,Default Value,Expected Value,Impact,Likelihood,Priority,RiskRating,References
CIS MEx 3.2.2 - Teams DLP Policies Not Enabled and Enforced,Enabling the default Teams DLP policy rule in Microsoft 365 helps protect an organization's sensitive information by preventing accidental sharing or leakage of that information in Teams conversations and channels.,Use the PowerShell script to create a new DLPCompliancePolicy or review the policies existence and if they are enabled.,"New-DlpCompliancePolicy -Name ""SSN Teams Policy"" -Comment ""SSN Teams Policy"" -TeamsLocation All -Mode Enable",Default Value:Enable,Enable,Enable,2,1,Informational,Low,Learn about data loss prevention
CIS MEx 3.3.1 - No SharePoint Online Data Classification Policies Set!,"By categorizing and applying policy-based protection, SharePoint Online Data Classification Policies can help reduce the risk of data loss or exposure, and enable more effective incident response if a breach does occur.",Use the PowerShell script to create a New Label Policy,"New-LabelPolicy -Name ""Example Name"" -Labels ""Example"",""Domain""",No Label Policy Active,No Policy,A Policy,2,4,Medium,Medium,Top sensitivity labels applied to content
CIS MEx 3.2.1 - DLP Policy is not enabled!,"Enabling DLP policies alerts users and administrators that specific types of data should not be exposed, helping to protect the data from accidental exposure.",Use the PowerShell script to configure a New-Dlp Compliance Policy,"New-DlpPolicy -Name ""Contoso PII"""" -Template {templatehere}",No DLP Policy Active,No Policy,A Policy,2,3,Informational,Medium,Learn about data loss prevention
CIS MEx 2.1.4 - Safe Attachments Not Enabled,"Enabling Safe Attachments policy helps protect against malware threats in email attachments by analyzing suspicious attachments in a secure, cloud-based environment before they are delivered to the user's inbox. This provides an additional layer of security and can prevent new or unseen types of malware from infiltrating the organization's network.",Run the following PowerShell command:,"$domains = Get-AcceptedDomain; New-SafeAttachmentPolicy -Name ""Safe Attachment Policy"" -Enable $true -Redirect $false -RedirectAddress $ITSupportEmail New-SafeAttachmentRule -Name ""Safe Attachment Rule"" -SafeAttachmentPolicy ""Safe Attachment Policy"" -RecipientDomainIs $domains[0]",No SafeAttachmentPolicy Found!,False,True,3,5,High,High,Deploy ATP with PowerShell
CIS MEx 2.1.7 - Anti-Phishing policy not has been created,"Protects users from phishing attacks (like impersonation and spoofing), and uses safety tips to warn users about potentially harmful messages.",Rune the following command to create a new AntiPhishPolicy,"$domains = Get-AcceptedDomain; New-AntiPhishPolicy -Name ""AntiPhish Policy"" -Enabled $true -EnableOrganizationDomainsProtection $true -EnableSimilarUsersSafetyTips $true -EnableSimilarDomainsSafetyTips $true -EnableUnusualCharactersSafetyTips $true -AuthenticationFailAction Quarantine -EnableMailboxIntelligenceProtection $true -MailboxIntelligenceProtectionAction movetoJMF -PhishThresholdLevel 2 -TargetedUserProtectionAction movetoJMF -EnableTargetedDomainsProtection $true -TargetedDomainProtectionAction MovetoJMF -EnableAntispoofEnforcement $true New-AntiPhishRule -Name ""AntiPhish Rule"" -AntiPhishPolicy ""AntiPhish Policy"" -RecipientDomainIs $domains[0]",No AntiPhish Policy Available,No Policy,A Policy,3,5,High,High,Securing Your Office 365 Tenants. Part 2
CIS MEx 2.4.2 - Priority accounts do not have 'Strict protection' presets applied,"Enabling priority account protection for users in Microsoft 365 is necessary to enhance security for accounts with access to sensitive data and high privileges, such as CEOs, CISOs, CFOs, and IT admins. These priority accounts are often targeted by spear phishing or whaling attacks and require stronger protection to prevent account compromise. To address this, Microsoft 365 and Microsoft Defender for Office 365 offer several key features that provide extra security, including the identification of incidents and alerts involving priority accounts and the use of built-in custom protections designed specifically for them.",Use the PowerShell Script to enable PriorityAccountProtection,"Enable-EOPProtectionPolicyRule -Identity ""Strict Preset Security Policy""; Enable-ATPProtectionPolicyRule -Identity ""Strict Preset Security Policy""",No Strict AntiPhishPolicy Available No Strict MalwareFilterPolicy Available No Strict HostedContentFilterPolicy Available No Strict SafeAttachmentPolicy Available No Strict SafeLinksPolicy Available No Strict EOPProtectionPolicy Available No Strict ATPProtectionPolicy Available,True,True,3,5,Medium,High,Preset security policies in EOP and Microsoft Defender for Office 365
CIS MEx 2.1.1 - Safe Links for Office Applications is not Enabled!,"Enabling Safe Links policy for Office applications allows URL's that exist inside of Office documents and email applications opened by Office, Office Online and Office mobile to be processed against Defender for Office time-of-click verification and rewritten if required. Safe Links for Office applications extends phishing protection to documents and emails that contain hyperlinks, even after they have been delivered to a user.",Use the PowerShell Script to create and apply the policy within your organization.,"$params = @{ Name = ""CIS SafeLinks Policy"" EnableSafeLinksForEmail = $true EnableSafeLinksForTeams = $true EnableSafeLinksForOffice = $true TrackClicks = $true AllowClickThrough = $false ScanUrls = $true EnableForInternalSenders = $true DeliverMessageAfterScan = $true DisableUrlRewrite = $false }; New-SafeLinksPolicy @params ; New-SafeLinksRule -Name ""CIS SafeLinks"" -SafeLinksPolicy ""CIS SafeLinks Policy"" -RecipientDomainIs (Get-AcceptedDomain).Name -Priority 0",Subscription is not Active. Thus SafeLinks is not working,Undefined,EnableSafeLinksForEmail: True EnableSafeLinksForTeams: True EnableSafeLinksForOffice: True TrackClicks: True AllowClickThrough: False ScanUrls: True EnableForInternalSenders: True DeliverMessageAfterScan: True DisableUrlRewrite: False,3,4,High,High,SafeLinks Policy Configuration
CIS MEx 2.1.5 - Safe Attachments for Office Applications is not Enabled!,"Safe Attachments for SharePoint, OneDrive, and Microsoft Teams protects organizations from inadvertently sharing malicious files. When a malicious file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.",Use the PowerShell Script to create and apply the policy within your organization.,Set-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true -EnableSafeDocs $true -AllowSafeDocsOpen $false,ATP Policy is not working!,Undefined,EnableATPForSPOTeamsODB: True EnableSafeDocs: True AllowSafeDocsOpen: False,2,5,High,High,Deploy ATP with PowerShell
CIS MAz 2.4.3 - Unable to verify if Microsoft Defender for Cloud Apps is enabled and configured,"Security teams can receive notifications of triggered alerts for atypical or suspicious activities, see how the organization's data in Microsoft 365 is accessed and used, suspend user accounts exhibiting suspicious activity, and require users to log back in to Microsoft 365 apps after an alert has been triggered","The implementation of Microsoft Defender for Cloud App MUST be done manually, because there is no automatic script available at this moment.",https://learn.microsoft.com/en-us/defender-cloud-apps/get-started,,No Microsoft Defender for Cloud Apps active,Microsoft Defender for Cloud Apps active,0,0,Informational,Informational,Microsoft Defender for Cloud Apps - Get Started
CISMAz 5.1.1.1 - The Security Defaults are enabled on Azure Active Directory Tenant,Security defaults in Azure Active Directory (Azure AD) make it easier to be secure and help protect your organization. Security defaults contain preconfigured security settings for common attacks.,Use the PowerShell Script to disable Security Defaults on Microsoft Azure Active Directory,"$body = $body = (@{""isEnabled""=""false""} | ConvertTo-Json) ;Invoke-MgGraphRequest -Method PATCH https://graph.microsoft.com/beta/policies/identitySecurityDefaultsEnforcementPolicy -Body $body",True,"True for tenants created later than 2019, False for tenants created before 2019",False,4,1,Medium,Low,Security defaults in Microsoft Entra ID
CIS Az 1.5 - Number of methods required to reset a password is not set to 2 or more methods,"A Self-service Password Reset (SSPR) through Azure Multi-factor Authentication (MFA) ensures the user's identity is confirmed using two separate methods of identification. With multiple methods set, an attacker would have to compromise both methods before they could maliciously reset a user's password.",Manually change the value from 1 to 2 in the Azure Portal. There is no script available at this moment unfortunately.,https://portal.azure.com/#view/Microsoft_AAD_IAM/PasswordResetMenuBlade/~/AuthenticationMethods,1,2,2,3,1,High,Low,Tutorial: Enable users to unlock their account or reset passwords using Microsoft Entra self-service password reset
CIS Az 2.1.19 - Notify about alerts with the following severity is not Set to High,Enabling security alert emails ensures that security alert emails are received from Microsoft. This ensures that the right people are aware of any potential security issues and are able to mitigate the risk.,You can change the settings in the URL written in PowerShellScript.,https://portal.azure.com/#view/Microsoft_Azure_SubscriptionManagement/ManageSubscriptionPoliciesBlade,,High,High,3,1,Medium,Low,Quickstart: Configure email notifications for security alerts
CIS Az 5.1.1 - 'Diagnostic Setting' does not exist for some Subscription Activity Logs,"A diagnostic setting controls how a diagnostic log is exported. By default, logs are retained only for 90 days. Diagnostic settings should be defined so that logs can be exported and stored for a longer duration in order to analyze security activities within an Azure subscription.",Use the PowerShell Script to remediate the issue.,New-AzDiagnosticSetting,,Disabled,Enabled,2,1,Low,Low,Overview of Azure platform logs
CIS Az 2.2.1 - Ensure That Microsoft Defender for IoT Hub Is Set To 'On',IoT devices are very rarely patched and can be potential attack vectors for enterprise networks. Updating their network configuration to use a central security hub allows for detection of these breaches,You can change the settings in the URL written in PowerShellScript.,https://portal.azure.com/#view/Microsoft_Azure_SubscriptionManagement/ManageSubscriptionPoliciesBlade,Unable to audit...,Off,On,2,1,Low,Low,Defender EASM Overview
CIS MAz 5.2.4.1 - Self Service Password Reset is not set to be enabled for all users,"Users will no longer need to engage the helpdesk for password resets, and the password reset mechanism will automatically block common, easily guessable passwords.",Manually change the value from 0 (None) or 1 (Selected) to 2 (All) in the Azure Portal. There is no script available at this moment unfortunately.,https://entra.microsoft.com/#view/Microsoft_AAD_IAM/PasswordResetMenuBlade/~/Properties,0,0,2,3,3,High,Medium,Let users reset their own passwords
CISMAz 5.1.5.2 - User consent to apps accessing company data on their behalf is allowed!,"Attackers commonly use custom applications to trick users into granting them access to company data. Disabling future user consent operations setting mitigates this risk, and helps to reduce the threat-surface. If user consent is disabled previous consent grants will still be honored but all future consent operations must be performed by an administrator.",Use the PowerShell Script disable user consent for Non-Admin Users.,$params = @{ defaultUserRolePermissions = @{ permissionGrantPoliciesAssigned = @() } }; Update-MgPolicyAuthorizationPolicy -BodyParameter $params,ManagePermissionGrantsForSelf.microsoft-user-default-legacy ManagePermissionGrantsForOwnedResource.microsoft-dynamically-managed-permissions-for-team ManagePermissionGrantsForOwnedResource.microsoft-dynamically-managed-permissions-for-chat,Null,Null,3,2,Medium,Medium,Configure how users consent to applications
CIS Az 1.6 - No Custom Bad Password List is set to 'Enforce' for your Organization,"Enabling this gives your organization further customization on what secure passwords are allowed. Setting a bad password list enables your organization to fine-tune its password policy further, depending on your needs. Removing easy-to-guess passwords increases the security of access to your Azure resources",Manually enable Enforce custom list and set it to True. There is no script available at this moment unfortunately.,https://portal.azure.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/PasswordProtection,CustomBannedPasswords: False PolicyMode: 0,False + No List,True + List with passwords,1,5,Medium,Medium,Combined password policy and check for weak passwords in Microsoft Entra ID
CISM MAz 5.2.3.2 - No Custom Bad Password List is used within your organization,"Creating a new password can be difficult regardless of one's technical background. It is common to look around one's environment for suggestions when building a password, however, this may include picking words specific to the organization as inspiration for a password. An adversary may employ what is called a 'mangler' to create permutations of these specific words in an attempt to crack passwords or hashes making it easier to reach their goal.",Manually enable Enforce custom list and set it to True. There is no script available at this moment unfortunately.,https://portal.azure.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/PasswordProtection,CustomBannedPasswords: False PolicyMode: 0,False + No List,True + List with passwords,1,5,Medium,Medium,Tutorial: Configure custom banned passwords for Microsoft Entra password protection
CIS Az 2.1.18 - Additional email addresses is not Configured with any Security Contact Email,Microsoft Defender for Cloud emails the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.,You can change the settings in the URL written in PowerShellScript or enable an Azure Policy for your organization.,https://portal.azure.com/#view/Microsoft_Azure_SubscriptionManagement/ManageSubscriptionPoliciesBlade,No Emailaddresses specified,"By default, there are no additional email addresses entered.",An email address,1,5,Medium,Medium,Quickstart: Configure email notifications for security alerts
CIS MAz 5.1.2.6 - LinkedIn Account Connections is enabled!,Disabling LinkedIn integration prevents potential phishing attacks and risk scenarios where an external party could accidentally disclose sensitive information.,Change the value to 1 (No) to disable LinkedIn,https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/UserSettings,enableLinkedInAppFamily: 0,0,1,1,5,Medium,Medium,Integrate LinkedIn account connections in Microsoft Entra ID
CIS MAz 5.3.1 - Verify if Priviledged Identity Management (PIM) is used to manage roles,"Organizations want to minimize the number of people who have access to secure information or resources, because that reduces the chance of a malicious actor getting that access, or an authorized user inadvertently impacting a sensitive resource. However, users still need to carry out privileged operations in Azure AD and Office 365. Organizations can give users just-in-time (JIT) privileged access to roles. There is a need for oversight for what those users are doing with their administrator privileges. PIM helps to mitigate the risk of excessive, unnecessary, or misused access rights.",Unfortunately we cannot accurately detect if a Privileged Identity Management is active. In order to check this you must have AAD P2 License assigned to your subscription.,https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/quickstart/resourceId//resourceType/tenant/provider/aadroles,"Please manually check if Priviledged Identity Management is enabled. Privileged Identity Management can't be used, because no P2 License is assigned!",No Policy,A Correctly Configured Policy,1,5,Medium,Medium,Create an access review of groups and applications in Mirosoft Entra ID
CIS Az 1.17 - Restrict user ability to access groups features in the Access Pane is Set to 'No',"Self-service group management enables users to create and manage security groups or Office 365 groups in Microsoft Entra ID. Unless a business requires this day-to-day delegation for some users, self-service group management should be disabled.",Change the Value to False to restrict non-admin users from accessing sensitive data. There is no automatic script available at this moment unfortunately.,https://portal.azure.com/#view/Microsoft_AAD_IAM/GroupsManagementMenuBlade/~/General,Restrict user ability to access groups features in the Access Panel is Set to : True,True,False,1,5,Medium,Medium,Set up self-service group management in Microsoft Entra ID
CIS Az 1.1.4 - Allow users to remember multi-factor authentication on devices they trust is Enabled,"Remembering Multi-Factor Authentication (MFA) for devices and browsers allows users to have the option to bypass MFA for a set number of days after performing a successful sign-in using MFA. This can enhance usability by minimizing the number of times a user may need to perform two-step verification on the same device. However, if an account or device is compromised, remembering MFA for trusted devices may affect security. Hence, it is recommended that users not be allowed to bypass MFA.",Check via the link,https://account.activedirectory.windowsazure.com/UserManagement/MfaSettings.aspx,Check the value here: https://account.activedirectory.windowsazure.com/UserManagement/MfaSettings.aspx,Disabled,Disabled,4,1,Medium,Medium,Configure Microsoft Entra multifactor authentication settings
CIS Az 1.10 - User consent for applications is not set to: 'Do not allow user consent',"If Microsoft Entra ID is running as an identity provider for third-party applications, permissions and consent should be limited to administrators or pre-approved. Malicious applications may attempt to exfiltrate data or abuse privileged user accounts",Goto: https://portal.azure.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings or Use the PowerShell Command,Import-Module Microsoft.Graph.Identity.SignIns; $params = @{DefaultUserRolePermissions = @{PermissionGrantPoliciesAssigned = @()}}; Update-MgPolicyAuthorizationPolicy -BodyParameter $params,ManagePermissionGrantsForSelf.microsoft-user-default-legacy ManagePermissionGrantsForOwnedResource.microsoft-dynamically-managed-permissions-for-team ManagePermissionGrantsForOwnedResource.microsoft-dynamically-managed-permissions-for-chat,Allow user consent for apps,"Do not allow user consent or Allow user consent for apps from verified publishers, for selected permissions",3,4,High,Medium,Admin Consent for Permissions in Azure Active Directory
CIS MAz 5.2.2.5 - Phishing-resistant MFA strength must be required for Administrators,Sophisticated attacks targeting MFA are more prevalent as the use of it becomes more widespread. These 3 methods are considered phishing-resistant as they remove passwords from the login workflow. It also ensures that public/private key exchange can only happen between the devices and a registered provider which prevents login to fake or phishing websites..,Configure the policy at the ConditionalAccess Blade below in the PowerShell Script. There is a Policy Template available which you can create if there is no such policy created beforehand.,https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies,No Policy Configured!,No Policy,,2,5,Medium,High,Passwordless authentication options for Microsoft Entra ID
CIS Az 1.14 - Guest users access restrictions is not set to 'Guest user access is restricted to properties and memberships of their own directory objects',"Limiting guest access ensures that guest accounts do not have permission for certain directory tasks, such as enumerating users, groups or other directory resources, and cannot be assigned to administrative roles in your directory. Guest access has three levels of restriction. 1. Guest users have the same access as members (most inclusive)  2. Guest users have limited access to properties and memberships of directory objects 3. Guest user access is restricted to properties and memberships of their own directory objects The recommended option is the 3rd, most restrictive: 'Guest user access is restricted to their own directory object'",Use the PowerShell Script to mitigate this issue:,"Update-MgPolicyAuthorizationPolicy -GuestUserRoleId ""2af84b1e-32c8-42b7-82bc-daa82404023b""",10dae51f-b6af-4016-8d66-8c2a99b929b3,10dae51f-b6af-4016-8d66-8c2a99b929b3,2af84b1e-32c8-42b7-82bc-daa82404023b,3,5,High,High,Member and guest users
CIS MAz 5.2.3.4 - Not all member users are 'MFA capable',"Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Users who are not MFA Capable have never registered a strong authentication method for multifactor authentication that is within policy and may not be using MFA. This could be a result of having never signed in, exclusion from a Conditional Access (CA) policy requiring MFA, or a CA policy does not exist. Reviewing this list of users will help identify possible lapses in policy or procedure",Implement a CA policy to require all users to use MFA and include all users,https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/UserRegistrationDetails/fromNav/Identity,file://C:\Out\CISMAz5234-NotCapableMFAUsers.txt,IsMFACapable: false if there is no CA policy enforcing MFA,IsMFACapable: true,3,5,High,High,View applied Conditional Access policies in Microsoft Entra sign-in logs
CIS MAz 5.2.2.2 - MultiFactor Authentication (MFA) is not enabled for all users non-administrative roles,"Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.",It is recommended to enable MFA via Conditional Access if the license is applicable. There is no new script available. You can use the old MSOL Script if you want to enable per-user MFA,https://admindroid.sharepoint.com/:u:/s/external/EVzUDxQqxWdLj91v3mhAipsBt0GqNmUK5b4jFXPr181Svw?e=OOcfQn&isSPOFile=1,Number of User Accounts without MFA: 11,"True for tenants >2019, False for tenants <2019",Number of User Accounts without MFA: 0,3,5,High,High,Common Conditional Access policy: Require MFA for administrators
CIS Az 1.13 - Users Can Register Applications Is Set to 'Yes',It is recommended to only allow an administrator to register custom-developed applications. This ensures that the application undergoes a formal security review and approval process prior to exposing Microsoft Entra ID data. Certain users like developers or other high-request users may also be delegated permissions to prevent them from waiting on an administrative user. Your organization should review your policies and decide your needs.,Use the PowerShell Script to enable Security Defaults on Microsoft Entra ID,Import-Module Microsoft.Graph.Identity.SignIns; $params = @{AllowedToCreateApps = $false}; Update-MgPolicyAuthorizationPolicy -BodyParameter $params,True,True,False,3,5,Medium,High,Restrict who can create applications
CIS MAz 5.2.3.1 - Microsoft Authenticator is not configured to protect against MFA fatigue,"As the use of strong authentication has become more widespread, attackers have started to exploit the tendency of users to experience 'MFA fatigue.' This occurs when users are repeatedly asked to provide additional forms of identification, leading them to eventually approve requests without fully verifying the source. To counteract this, number matching can be employed to ensure the security of the authentication process. With this method, users are prompted to confirm a number displayed on their original device and enter it into the device being used for MFA. Additionally, other information such as geolocation and application details are displayed to enhance the end user's awareness. Among these 3 options, number matching provides the strongest net security gain.",Navigate to Microsoft Entra and select Microsoft Authenticator. Review the settings and set it to all_users and enable the first 3 options in the Configure section.,https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods,displayAppInformationRequiredState: default targetid: all_users,"Enabled for tenants >2022, Disabled for tenants <2022",From 2023 if not manually assigned it would be enabled if Microsoft manages the setting.,3,5,High,High,Protecting authentication methods in Microsoft Entra ID
"CIS Az 1.18 - Users can create security groups in Azure portals, API or PowerShell","When creating security groups is enabled, all users in the directory are allowed to create new security groups and add members to those groups. Unless a business requires this day-to-day delegation, security group creation should be restricted to administrators only.",Use the Powershell Script to modify the policy to disallow Tenant Creation by unauthorized users,"$RolePermissions = @{}; $RolePermissions[""AllowedToCreateSecurityGroups""] = $False; Update-MgPolicyAuthorizationPolicy -AuthorizationPolicyId ""authorizationPolicy"" -DefaultUserRolePermissions $RolePermissions",AllowedToCreateSecurityGroups: True,True,False,3,5,High,High,Set up self-service group management in Microsoft Entra ID
CIS Az 1.1.3 - Multi-Factor Auth Status is 'Disabled' for some non-privileged Users,"Multi-factor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multi-factor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multi-factor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk",Please enable MFA for all users through the Admin Portal. You can also use the legacy script by Adminroid,https://admindroid.sharepoint.com/:u:/s/external/EVzUDxQqxWdLj91v3mhAipsBt0GqNmUK5b4jFXPr181Svw?e=OOcfQn&isSPOFile=1,13 Users have MFA Disabled,All Users have no MFA Enabled,All Users have MFA Enabled,3,5,High,High,How it works: Microsoft Entra multifactor authentication
CIS Az 1.9 - Notify all admins when other admins reset their password?' is set to 'No',"Global Administrator accounts are sensitive. Any password reset activity notification, when sent to all Global Administrators, ensures that all Global administrators can passively confirm if such a reset is a common pattern within their group. For example, if all Global Administrators change their password every 30 days, any password reset activity before that may require administrator(s) to evaluate any unusual activity and confirm its origin.",Change the value manually. There is no automatic script available at this moment unfortunately.,https://portal.azure.com/#view/Microsoft_AAD_IAM/PasswordResetMenuBlade/~/Notifications,Notify all admins when other admins reset their password? is set to: False,False,True,3,5,High,High,Notifications
CIS MAz 5.1.2.1 - Some User Accounts do not have MFA enabled,"Both security defaults and conditional access with security defaults turned off are not compatible with per-user multi-factor authentication (MFA), which can lead to undesirable user authentication states. The CIS Microsoft 365 Benchmark explicitly employs Conditional Access for MFA as an enhancement over security defaults and as a replacement for the outdated per-user MFA. To ensure a consistent authentication state disable per-user MFA on all accounts.",Please enable MFA for all users through the Admin Portal. You can also use the legacy script by Adminroid,https://admindroid.sharepoint.com/:u:/s/external/EVzUDxQqxWdLj91v3mhAipsBt0GqNmUK5b4jFXPr181Svw?e=OOcfQn&isSPOFile=1,13,Disabled,All Users have MFA Enabled,3,5,High,High,Enable per-user Microsoft Entra multifactor authentication to secure sign-in events
CIS Az 1.25 - There are less than 1 or more than 5 users with an global administrator assignment,"The Global Administrator role has extensive privileges across all services in Microsoft Entra ID. The Global Administrator role should never be used in regular daily activities; administrators should have a regular user account for daily activities, and a separate account for administrative responsibilities. Limiting the number of Global Administrators helps mitigate the risk of unauthorized access, reduces the potential impact of human error, and aligns with the principle of least privilege to reduce the attack surface of an Azure tenant. Conversely, having at least two Global Administrators ensures that administrative functions can be performed without interruption in case of unavailability of a single admin.",Use the Security and Compliance Center to review the administrative privileges granted to the users listed and determine if each user truly requires their administrative privileges. In many cases a more granular set of permissions may be appropriate. Reduce the privileges of each user as appropriate.,,8,1,Between two and four,3,4,High,High,Limit the number of Global Administrators to less than 5
CIS Az 1.11 - User consent for applications is not set to: 'Do not allow user consent' or 'Allow for Verified Publishers',"If Microsoft Entra ID is running as an identity provider for third-party applications, permissions and consent should be limited to administrators or pre-approved. Malicious applications may attempt to exfiltrate data or abuse privileged user accounts.",Goto: https://portal.azure.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings or Use the PowerShell Command,Import-Module Microsoft.Graph.Identity.SignIns; $params = @{DefaultUserRolePermissions = @{PermissionGrantPoliciesAssigned = @()}}; Update-MgPolicyAuthorizationPolicy -BodyParameter $params,ManagePermissionGrantsForSelf.microsoft-user-default-legacy ManagePermissionGrantsForOwnedResource.microsoft-dynamically-managed-permissions-for-team ManagePermissionGrantsForOwnedResource.microsoft-dynamically-managed-permissions-for-chat,Allow user consent for apps,"Do not allow user consent or Allow user consent for apps from verified publishers, for selected permissions",3,4,High,High,Configure how users consent to applications
CIS MAz 5.1.2.2 - Third party integrated applications are allowed!,"Third party integrated applications connection to services should be disabled, unless there is a very clear value and robust security controls are in place. While there are legitimate uses, attackers can grant access from breached accounts to third party applications to exfiltrate data from your tenancy without having to maintain the breached account.",Manually change it here: https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings,https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/UserSettings,AllowedToCreateApps: True,AllowedToCreateApps: True,AllowedToCreateApps: False,2,5,Medium,High,How and why applications are added to Microsoft Entra ID
CIS MAz 5.2.2.4 - Ensure Sign-in frequency is enabled and browser sessions are not persistent for Administrative users,"Forcing a time out for MFA will help ensure that sessions are not kept alive for an indefinite period of time, ensuring that browser sessions are not persistent will help in prevention of drive-by attacks in web browsers, this also prevents creation and saving of session cookies leaving nothing for an attacker to take.",You can navigate to the Entry Portal and the Conditional Access blade to configure the policy.,https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies,No Policy Configured!,No Policy,presistentBrowserMode: never and isEnabled: true | signInFrequencyValue: between 4 and 24 and timevalue: hours | clientAppTypes: All | applicationsIncludeApplications: All | grantControls.builtInControls: mfa,2,5,Medium,High,Configure adaptive session lifetime policies
CIS MAz 5.2.2.7 - Verify if you have an Azure AD Identity Protection sign-in risk policy enabled,Turning on the sign-in risk policy ensures that suspicious sign-ins are challenged for multi-factor authentication.,Unfortunately we cannot accurately detect if a sign-in risk policy is enabled. If you have a sign-in risk policy. Please verify if the settings are configured correctly.,https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies,No Conditional Access Policy Configured!,No Policy,A Correctly Configured Policy,2,5,High,High,How To: Give risk feedback in Azure AD Identity Protection
CIS MAz 5.2.2.6 - Verify if you have an Azure AD Identity Proteciton user risk policy enabled,"With the user risk policy turned on, Azure AD detects the probability that a user account has been compromised. Administrators can configure a user risk conditional access policy to automatically respond to a specific user risk level.",Unfortunately we cannot accurately detect if a user risk risk policy is enabled. If you have a user risk policy. Please verify if the settings are configured correctly.,https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies,No Conditional Access Policy Configured!,No Policy,A Correctly Configured Policy,2,5,High,High,How To: Give risk feedback in Azure AD Identity Protection
CIS Az 1.3 - Restrict non-admin users from creating tenants is set to No,It is recommended to only allow an administrator to create new tenants. This prevent users from creating new Azure AD or Azure AD B2C tenants and ensures that only authorized users are able to do so.,Use the Powershell Script to modify the policy to disallow Tenant Creation by unauthorized users,"$RolePermissions = @{}; $RolePermissions[""allowedToCreateTenants""] = $False; Update-MgPolicyAuthorizationPolicy -AuthorizationPolicyId ""authorizationPolicy"" -DefaultUserRolePermissions $RolePermissions",True,True,False,2,5,Medium,High,What are the default user permissions in Microsoft Entra ID?
CIS MAz 5.1.2.4 - Access to the Azure AD administration portal is not restricted!,"The Azure AD administrative (AAD) portal contains sensitive data and permission settings, which are still enforced based on the user's role. However, an end user may inadvertently change properties or account settings that could result in increased administrative overhead. Additionally, a compromised end user account could be used by a malicious attacker as a means to gather additional information and escalate an attack.",Change the value to True (Yes) to restrict access to the AD portal,https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/UserSettings,restrictNonAdminUsers: False,restrictNonAdminUsers: False,restrictNonAdminUsers: True,2,5,High,High,Restrict member users default permissions
CIS MAz 5.1.2.3 - Non-Admin Users can create new tenants!,"Restricting tenant creation prevents unauthorized or uncontrolled deployment of resources and ensures that the organization retains control over its infrastructure. User generation of shadow IT could lead to multiple, disjointed environments that can make it difficult for IT to manage and secure the organization's data, especially if other users in the organization began using these tenants for business purposes under the misunderstanding that they were secured by the organization's security team.",Change the value to False (Yes) to restrict non-admins from creating tenants! Or use the PowerShell script to restrict non-admins.,"$params = @{ DefaultUserRolePermissions = @{ AllowedToCreateTenants = $false } }; Update-MgBetaPolicyAuthorizationPolicy -AuthorizationPolicyId ""authorizationPolicy"" -BodyParameter $params",allowedToCreateTenants: True,AllowedToCreateTenants: True,AllowedToCreateTenants: False,2,5,Medium,High,Restrict member users default permissions
CIS Az 1.16 - 'Restrict access to Azure AD administration portal is set to 'No',The Microsoft Entra ID administrative portal has sensitive data and permission settings. All non-administrators should be prohibited from accessing any Entra ID data in the administration portal to avoid exposure,Change the Value to True to restrict non-admin users from accessing sensitive data. There is no automatic script available at this moment unfortunately.,https://portal.azure.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings,Restrict access to Azure AD administration portal is set to:,False,True,2,5,High,High,The Azure AD portal strikes back
CIS Az 1.15 - Guest invite restrictions is not set to 'Only users assigned to specific admin roles can invite guest users',"Restricting invitations to users with specific administrator roles ensures that only authorized accounts have access to cloud resources. This helps to maintain 'Need to Know' permissions and prevents inadvertent access to data. By default the setting Guest invite restrictions is set to Anyone in the organization can invite guest users including guests and non-admins. This would allow anyone within the organization to invite guests and non-admins to the tenant, posing a security risk.",Use the PowerShell Script to mitigate this issue:,"Update-MgPolicyAuthorizationPolicy -AllowInvitesFrom  ""adminsAndGuestInviters""",everyone,everyone,adminsAndGuestInviters,2,5,Informational,High,Configure external collaboration settings
CIS MAz 5.2.2.8 - Ensure Microsoft Azure Management is limited to administrative roles,"Blocking sign-in to Azure Management applications and portals enhances security of sensitive data by restricting access to privileged users. This mitigates potential exposure due to administrative errors or software vulnerabilities, as well as acting as a defense in depth measure against security breaches.",Unfortunately we cannot accurately detect if correctly configured. If you have a existing policy. Please verify if the settings are configured correctly.,https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies,Could not verify is policy exists!,No Policy and Non-administrators can access the Azure AD administration portal,A Correctly Configured Policy Non-administrators cannot access the Azure AD administration portal,2,5,High,High,"Conditional Access: Cloud apps, actions, and authentication context"
CIS Az 1.1.2 - Multi-Factor Auth Status is 'Disabled' for some privileged Users,"Multi-factor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multi-factor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multi-factor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.",Please enable MFA for all Admin users through the Admin Portal. You can also use the legacy script by Adminroid,https://admindroid.sharepoint.com/:u:/s/external/EVzUDxQqxWdLj91v3mhAipsBt0GqNmUK5b4jFXPr181Svw?e=OOcfQn&isSPOFile=1,2 Admins have MFA Disabled,All Admins have no MFA Enabled,All Admins have MFA Enabled,4,5,Critical,Critical,How it works: Microsoft Entra multifactor authentication
CIS MAz 5.2.2.1 - MultiFactor Authentication (MFA) is not enabled for all users in administrative roles,"Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.",It is recommended to enable MFA via Conditional Access if the license is applicable. There is no new script available. You can use the old MSOL Script if you want to enable per-user MFA,https://admindroid.sharepoint.com/:u:/s/external/EVzUDxQqxWdLj91v3mhAipsBt0GqNmUK5b4jFXPr181Svw?e=OOcfQn&isSPOFile=1,Number of Admin Accounts without MFA: 2,"True for tenants >2019, False for tenants <2019",Number of Admin Accounts without MFA: 0,4,5,Critical,Critical,Use the Microsoft Graph security API
CIS MSp 7.2.8 - Ensure external sharing is restricted by security group!,Organizations wishing to create tighter security controls for external sharing can set this to enforce role-based access control by using security groups already defined in Microsoft Entra.,Use the link to access the sharepoint settings and change the setting there,https://contoso-admin.sharepoint.com/_layouts/15/online/AdminHome.aspx#/sharing,Cannot Verify!,Unchecked,Checked,0,0,Informational,Informational,Allow only members in specific security groups to share SharePoint and OneDrive files and folders externally
CIS MOff 1.2.1 - Public Microsoft 365 Groups Found!,"Ensure that only organizationally managed and approved public groups exist. When a group has a 'public' privacy, users may access data related to this group.",Remove or make specific groups private,-,9,0 Public Groups,0 Public Groups,0,0,Informational,Informational,Groups Self-Service Management
CIS MOff 1.3.8 - Sways can be shared with people outside of your organization,Disable external sharing of Sway documents that can contain sensitive information to prevent accidental or arbitrary data leak.,Manually uncheck at Sway Setting in the Admin Portal. The respective setting: 'Let people in your organization share their sways with people outside your organization',https://admin.microsoft.com/Adminportal/Home#/Settings/Services/:/Settings/L1/Sway,ExternalSharingEnabled: True,True,False,3,1,Informational,Low,Administrator settings for Microsoft Forms
CIS MOff 1.3.2 - 'Idle Session Timeout' for unmanaged devices is not set to 3 hours or less!,"Ending idle sessions through an automatic process can help protect sensitive company data, and will add another layer of security for end users who work on unmanaged devices that can potentially be accessed by the public. Unauthorized individuals onsite or remotely can take advantage of systems left unattended over time. Automatic timing out of sessions makes this more difficult.",Manually change the value to 3 hour or less and enable the checkbox if not done in the portal.,https://admin.microsoft.com/Adminportal/Home#/Settings/SecurityPrivacy,TimeoutString: Never TimeoutValue: 0,TimeoutString: Never TimeoutValue: 0,TimeoutString: NOT Never TimeoutValue: <180,2,4,Medium,Medium,Idle session timeout for Microsoft 365
CIS MOff 1.3.7 - 'third-party storage services' are not restricted in 'Microsoft 365 on the web',"By using external storage services an organization may increases the risk of data breaches and unauthorized access to confidential information. Additionally, third-party services may not adhere to the same security standards as the organization, making it difficult to maintain data privacy and security.",Manually uncheck the box 'Let users open files stored in third-party storage services in Microsoft 365 on the web'. The URL is given in PowerShellScript.,https://admin.microsoft.com/Adminportal/Home#/Settings/Services/:/Settings/L1/OfficeOnline,Enabled: True,Enabled: True,Enabled: False,3,5,High,High,Enable or disable third-party storage services
CIS MOff 1.3.4 - User owned apps and services are not restricted,"Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disable future user's ability to install add-ins in Microsoft Word, Excel, or PowerPoint helps reduce your threat-surface and mitigate this risk.",Manually uncheck at User owned apps and services the first two options so all 3 checkboxes are unchecked.,https://admin.microsoft.com/Adminportal/Home#/Settings/Services/:/Settings/L1/Store,iwpurchaseallowed: True iwpurchasefeatureenabled: True,iwpurchaseallowed: True / iwpurchasefeatureenabled: True,iwpurchaseallowed: False / iwpurchasefeatureenabled: False,3,5,High,High,Microsoft Admin Portal
CIS MOff 1.1.1 -  Ensure Administrative accounts are separate and cloud-only,"Ensuring administrative accounts are cloud-only, without applications assigned to them will reduce the attack surface of high privileged identities in your environment. In order to participate in Microsoft 365 security services such as Identity Protection, PIM and Conditional Access an administrative account will need a license attached to it. Ensure that the license used does not include any applications with potentially vulnerable services by using either Microsoft Entra ID P1 or Microsoft Entra ID P2 for the cloud-only account with administrator roles.",You can review the list of accounts containing a license and change them in the Microsoft 365 Portal,https://admin.microsoft.com/,User: AdeleV@pathwardenmakeit.ip-dynamic.org has licence(s): DEVELOPERPACK_E5,-,0,4,3,High,High,Add users and assign licenses at the same time
CIS MOff 1.1.3 - There are 1 global admins designated,"If there is only one global tenant administrator, he or she can perform malicious activity without the possibility of being discovered by another admin. If there are numerous global tenant administrators, the more likely it is that one of their accounts will be successfully breached by an external attacker.",Create an extra Global Admin Account if you only have one or remove Global Admin permissions from accounts if you have more than four.,https://admin.microsoft.com/,1,1,Between 2 and 4,4,3,High,High,Manage emergency access accounts in Microsoft Entra ID
CIS MOff 1.1.2 - Less than 2 emergency access accounts have been defined,"In various situations, an organization may require the use of a break glass account to gain emergency access. In the event of losing access to administrative functions, an organization may experience a significant loss in its ability to provide support, lose insight into its security posture, and potentially suffer financial losses.",Create an extra Global Admin Account if you only have one.,https://admin.microsoft.com/,1,1,2,4,3,High,High,Manage emergency access accounts in Microsoft Entra ID
